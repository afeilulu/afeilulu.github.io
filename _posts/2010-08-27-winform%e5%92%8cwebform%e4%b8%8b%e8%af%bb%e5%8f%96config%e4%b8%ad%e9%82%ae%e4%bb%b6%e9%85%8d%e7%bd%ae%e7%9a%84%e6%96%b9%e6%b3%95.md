---
layout: post
title: WinForm和WebForm下读取config中邮件配置的方法
date: 2010-08-27 09:52
author: afeilulu
comments: true
categories: [program]
---
<div id="msgcns!4C815953D6B638F4!397" class="bvMsg"><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">1.  在WinForm下读取 App.config中的邮件配置语句如下：</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">//OpenExeConfiguration2个方法的参数我也没搞清楚到底该怎么用。<br />MailSettingsSectionGroup mailSettings = .NetSectionGroup.GetSectionGroup(config).MailSettings;</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">App.config代码如下：</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">&lt;?Xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />&lt;configuration&gt;<br />    &lt;system.Net&gt;<br />        &lt;mailSettings&gt;<br />        &lt;smtp from=&quot;admin@wmdev.mobi&quot;&gt;<br />            &lt;.Network  host=&quot;smtp.wmdev.mobi&quot; <br />            userName=&quot;admin&quot; <br />            password=&quot;password&quot;/&gt;<br />        &lt;/smtp&gt;<br />       &lt;/mailSettings&gt;<br />    &lt;/system.Net&gt;<br />&lt;/configuration&gt;</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">2.  在WebForm下读取Web.config中的邮件配置代码如下：</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">Configuration config = WebConfigurationManager.OpenWebConfiguration(&quot;~/&quot;);<br />MailSettingsSectionGroup mailSettings = (MailSettingsSectionGroup)config.GetSectionGroup(&quot;system.Net/mailSettings&quot;);</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">//此处的&quot;system.Net/mailSettings“如果改成其他节点则读取其他的相应的配置信息 <br />Web.config代码如下：</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">与App.config一样</p><p style="color:rgb(34,34,34);font-family:宋体, Verdana;font-size:15px;line-height:27px;">&lt;?Xml version=&quot;1.0&quot; ?&gt;<br />&lt;configuration&gt;<br />    &lt;system.Net&gt;<br />        &lt;mailSettings&gt;<br />        &lt;smtp from=&quot;admin@wmdev.mobi&quot;&gt;<br />            &lt;.Network  host=&quot;smtp.wmdev.mobi&quot; <br />            userName=&quot;admin&quot; <br />            password=&quot;password&quot;/&gt;<br />        &lt;/smtp&gt;<br />       &lt;/mailSettings&gt;<br />    &lt;/system.Net&gt;<br />&lt;/configuration&gt;</p> </div>
